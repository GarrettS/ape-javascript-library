<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
<title>APE JavaScript Library Build Process</title>
<script>
// executeWhenLoaded() will be overloaded with as many arguments as i want to check for presence.
function executeWhenLoaded(func){  
 
  var args = [].slice.call(arguments, 1), j = 0;
  poll();
  function poll() {
      for (var i = 0; i< args.length; i++){ // for loop starts at 1 to skip the function argument.
        if (! window[ args[i] ]) {
          setTimeout(poll, 50);
          return;
        } 
      }
      func(); // only reaches here when for loop is satisfied.
  }
}
executeWhenLoaded(
    function(){
        alert(window.xnode);
    }, 
    'xnode'
);

</script>

<link type="text/css" rel="stylesheet" href="/res/skins/1.css"/>
<link type="text/css" rel="stylesheet" href="/ape/resources/ape.css"/>

<style type="text/css">
.xml {
    color: #850;
}
</style>

<body>
<h1>Build JavaScript with ANT and YUICompressor</h1>

<p>
    APE uses a build process to copy files from <kbd>/src</kbd> to <kbd>/build</kbd>
</p>

<h2>Rollups</h2>
<p>
    Rollups are generated by using the <a href="http://ant.apache.org/">ANT</a> 
    <code class="xml">&lt;concat&gt;</code> task.
</p>

<h3>Packaging</h3>
<p>
    APE Packages are based on narrowly-scoped modules. Modules offer a narrower 
    scope that has only very closely related functionlity (scope is created with a closure). 
    Because of their smaller scope, modules are easier to test than entire packages. 
</p>

<p>
    Modules of a package use the Exporting Pattern to add their functions to that package. 
    Each module declares its <code>Package</code> using <code>APE.namespace()</code>.
    This makes it possible to unit test the modules. 
</p>

<h4>ANT filterchain</h4>
<p>
    Only one <code>APE.namespace()</code> call is needed per package. A Package can contain 
    many modules, so the extra unneeded <code class="xml">namespace()</code> calls are stripped out using a 
    <code class="xml">&lt;filterchain&gt;</code> inside a <code class="xml">&lt;concat&gt;</code> task. 
</p>
<p>
    As a result of the build process, <code>APE.namespace()</code> is only called once for each package. 
</p>
<h4>Result</h4>
<p>
    The resulting rollup
    <a href="build/ape-ep-dom.js">ape-ep-dom.js</a> consists of several modules but 
    has a total of one <code>APE.namespace()</code> call for one package
    (<code>APE.dom</code>). 
</p>

<p>
    The <a href="build.xml">ANT Build File</a>.
</p>
<img src="/ape/resources/Gorilla Bongo.JPG"/>
<img src="/ape/resources/leaf.jpg"/>

<script>
var xnode = true;
</script>
</body>
</html>