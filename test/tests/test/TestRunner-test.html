<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
    <title>Mouse test</title>
    
    <script src="../../../build/domunit/domunit.js" type="text/javascript"></script>    
    <link type="text/css" rel="stylesheet" href="../../../build/test/css/TestReporter.css">
    
</head>
<body>
<script type="text/javascript">
function testTestRunner() {
    var test = APE.test,
        TestRunner = test.TestRunner,
        Assert = test.Assert,
        cond = test.NativeConstraints,
        Constraints = test.NativeConstraints;
    
    var waitSuite = {
        "test wait() actually waits" : function() {
            var waited;
            TestRunner.wait(function() {
                waited = true;
            }, 1);
            TestRunner.wait(function() {
                Assert.that(Constraints.isTrue(waited, "test did not wait."));
            }, 10);
        }
    };
    
    var waitForConditionSuite = {
            
            setUp : function() {
            },
            
            tearDown : function(test) {
            },
            
            "test waitForCondition() condition function called" : function() {
                var conditionCalled;
                
                function condition() {
                    return conditionCalled;
                }
                
                function deferredSeg() {
                    Assert.that(Constraints.isTrue(conditionCalled, "condition was not called."));
                }
                TestRunner.waitForCondition(condition, deferredSeg, 1000);
            },
            
            "test deferred segment called where condition is met" : function() {
                var conditionMet;
                setTimeout(function() {
                    conditionMet = true;
                }, 500);
                
                function condition() {
                    return conditionMet;
                }
                
                function deferredSeg() {
                    Assert.that(Constraints.isTrue(conditionMet, "condition() not called."));
                }
                TestRunner.waitForCondition(condition, deferredSeg, 1000);
            }
    }
    TestRunner.runTests([waitSuite, waitForConditionSuite]);
}

testTestRunner();
</script>
</body>
</html>