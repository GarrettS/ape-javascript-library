APE.namespace("APE.dom");(function(){var E=APE.dom,A="ownerDocument",D=document,F=D.documentElement,C=F&&typeof F[A]!=="undefined"?A:"document",B=D.defaultView;E.OWNER_DOCUMENT=C;E.IS_COMPUTED_STYLE=(typeof B!="undefined"&&"getComputedStyle" in B)})();(function(){APE.mixin(APE.dom,{getScrollOffsets:B,getViewportDimensions:C});var A="documentElement",D=document[A].clientWidth===0;function B(G){G=G||window;var F,E;if("pageXOffset" in G){F=function(H){H=H||window;return{left:H.pageXOffset,top:H.pageYOffset}}}else{F=function(I){I=I||window;var H=I.document[D?"body":A];return{left:H.scrollLeft,top:H.scrollTop}}}E=(this.getScrollOffsets=F)(G);G=null;return E}function C(I){I=I||window;var E="document",L=E,J=I[E],H="client",K,G;if(typeof J.clientWidth=="number"){E="window"}else{if(D){E=A;L="body"}else{if(J[A].clientHeight>0){L=A}}}K=H+"Width";G=H+"Height";function F(N){var M=(N||window)[E][L];return{width:M[K],height:M[G]}}r=(this.getViewportDimensions=F)(I);I=J=null;return r}})();(function(){var B=APE.dom,N=typeof document.createElement("p").scrollLeft=="number";APE.mixin(B,{getOffsetCoords:J,isAboveElement:U,isBelowElement:D,isInsideElement:P,IS_SCROLL_SUPPORTED:N});var I=this.document,c,O=I.documentElement,f=Math.round,W=Math.max,S=self.parseFloat,k="getComputedStyle",Z="defaultView",e=O&&O.clientWidth===0,Q="clientTop" in O,X=/^h/.test(O.tagName)?"table":"TABLE",j="currentStyle" in O,K,C,b,L,i,g,d,T,Y,F,A,H=I[Z]&&typeof I[Z][k]!="undefined",G="getBoundingClientRect",M="relative",R="borderTopWidth",a="borderLeftWidth",E=/^(?:r|a)/,V=/^(?:a|f)/;I=O=null;function J(m,AF,AL){var AR=m[B.OWNER_DOCUMENT],AP=AR.documentElement,AC=AR.body;if(!AF){AF=AR}if(!AL){AL={x:0,y:0}}AL.x=AL.y=0;if(m===AF){return AL}if(G in m){var AN=e?AC:AP,AA=m[G](),z=AA.left+W(AP.scrollLeft,AC.scrollLeft),v=AA.top+W(AP.scrollTop,AC.scrollTop),AK,AH=AN.clientTop,n=AN.clientLeft;if(Q){z-=n;v-=AH}if(AF!==AR){AA=J(AF,null);z-=AA.x;v-=AA.y;if(Q){if(e&&AF===AC){z-=n;v-=AH}else{if(AF!==AR&&AF!==AP&&AF!==AC){z-=AF.clientLeft;v-=AF.clientTop}}}}if(e&&j&&AF!=AR&&AF!==AC){AK=AC.currentStyle;z+=S(AK.marginLeft)||0+S(AK.left)||0;v+=S(AK.marginTop)||0+S(AK.top)||0}AL.x=z;AL.y=v;return AL}else{if(H){if(!c){h()}var t=m.offsetLeft,AM=m.offsetTop,AI=AR[Z],s=AI[k](m,"")||m.style;if(s.position=="fixed"&&N){AL.x=t+AP.scrollLeft;AL.y=AM+AP.scrollTop;return AL}var AB=AI[k](AC,""),AD=!E.test(AB.position),q=m,u=m.parentNode,l=m.offsetParent;for(;u&&u!==AF;u=u.parentNode){if(u!==AC&&u!==AP&&N){t-=u.scrollLeft;AM-=u.scrollTop}if(u===l){if(u===AC&&AD){}else{if(!K&&!(u.tagName===X&&i)){var p=AI[k](u,"");t+=S(p[a])||0;AM+=S(p[R])||0}if(u!==AC){t+=l.offsetLeft;AM+=l.offsetTop;q=l;l=u.offsetParent}}}}var w=0,AJ=0,AQ,AE,AO=AF===AR||AF===AP,AG,o;if(q!=AR){s=AI[k](q,"");if(s){o=s.position;AQ=V.test(o);AE=AQ||E.test(o)}}if((q===m&&m.offsetParent===AC&&!C&&AF!==AC&&!(AD&&L))||(C&&q===m&&!AE)||!AD&&AE&&d&&AO){AJ+=S(AB.marginTop)||0;w+=S(AB.marginLeft)||0}if(AF===AC){AG=AI[k](AP,"");if((!AD&&((Y&&!AQ)||(F&&AQ)))||AD&&T){AJ-=S(AG.paddingTop)||0;w-=S(AG.paddingLeft)||0}if(A){if(!AE||AE&&!AD){AJ-=S(AG.marginTop)||0}w-=S(AG.marginLeft)||0}}if(AD){if(g||(!AQ&&!K&&AO)){AJ+=S(AB[R]);w+=S(AB[a])}}else{if(L){if(AO){if(!b){AJ+=S(AB.top)||0;w+=S(AB.left)||0;if(AQ&&K){AJ+=S(AB[R]);w+=S(AB[a])}}if(AF===AR&&!AD&&!Y){if(!AG){AG=AI[k](AP,"")}AJ+=S(AG.paddingTop)||0;w+=S(AG.paddingLeft)||0}}else{if(b){AJ-=S(AB.top);w-=S(AB.left)}}if(C&&(!AE||AF===AC)){AJ-=S(AB.marginTop)||0;w-=S(AB.marginLeft)||0}}}AL.x=f(t+w);AL.y=f(AM+AJ);return AL}}}function h(){c=true;var AD=document,p=AD.body;if(!p){return}var l="marginTop",AF="position",t="padding",AC="static",w="border",q=p.style,AG=q.cssText,AB="1px solid transparent",m="0",v="1px",y="offsetTop",u=AD.documentElement.style,AE=u.cssText,o=AD.createElement("div"),n=o.style,AA=AD.createElement(X);q[t]=q[l]=q.top=m;u.position=AC;q[w]=AB;n.margin=m;n[AF]=AC;o=p.insertBefore(o,p.firstChild);K=(o[y]===1);q[w]=m;AA.innerHTML="<tbody><tr><td>x</td></tr></tbody>";AA.style[w]="7px solid";AA.cellSpacing=AA.cellPadding=m;p.insertBefore(AA,p.firstChild);i=AA.getElementsByTagName("td")[0].offsetLeft===7;p.removeChild(AA);q[l]=v;q[AF]=M;C=(o[y]===1);L=p[y]===0;q[l]=m;q.top=v;b=o[y]===1;q.top=m;q[l]=v;q[AF]=n[AF]=M;d=o[y]===0;n[AF]="absolute";q[AF]=AC;if(o.offsetParent===p){q[w]=AB;n.top="2px";g=o[y]===1;q[w]=m;n[AF]=M;u[t]=v;q[l]=m;T=o[y]===3;q[AF]=M;Y=o[y]===3;n[AF]="absolute";F=o[y]===3;u[t]=m;u[l]=v;A=o[y]===3}p.removeChild(o);q.cssText=AG||"";u.cssText=AE||""}function P(m,l){var o=J(m).y,n=J(l).y;return o+m.offsetHeight<=n+l.offsetHeight&&o>=n}function U(m,l){return(J(m).y<=J(l).y)}function D(m,l){return(J(m).y+m.offsetHeight>=J(l).y+l.offsetHeight)}})();(function(){APE.mixin(APE.dom,{hasToken:E,removeClass:J,addClass:F,getElementsByClassName:K,findAncestorWithClass:H});var G="className";function E(M,L){return B(L,"").test(M)}function J(M,L){var N=M[G];if(!N){return}if(N===L){M[G]="";return}M[G]=C(N.replace(B(L,"g")," "))}function F(M,L){if(!M[G]){M[G]=L}if(!B(L).test(M[G])){M[G]+=" "+L}}var A={};function B(M,L){var N=M+"$"+L;return(A[N]||(A[N]=RegExp("(?:^|\\s)"+M+"(?:$|\\s)",L)))}function K(M,N,T){if(!T){return[]}N=N||"*";if(M.getElementsByClassName&&(N==="*")){return M.getElementsByClassName(T)}var O=B(T,""),Q=M.getElementsByTagName(N),R=Q.length,L=0,P,S=Array(R);for(P=0;P<R;P++){if(O.test(Q[P][G])){S[L++]=Q[P]}}S.length=L;return S}function H(O,L,M){if(O==null||O===M){return null}var P=B(L,""),N;for(N=O.parentNode;N!=M;){if(P.test(N[G])){return N}N=N.parentNode}return null}var D=/^\s+|\s+$/g,I=/\s\s+/g;function C(L){return L.replace(D,"").replace(I," ")}})();(function(){var D=document.documentElement,B="getNamedItem" in D.attributes,K="nodeType",L="compareDocumentPosition",I="parentNode",F=/^H/.test(D.tagName)?"toUpperCase":"toLowerCase";APE.mixin(APE.dom,{contains:H(),findAncestorWithAttribute:A,findAncestorWithTagName:J,findNextSiblingElement:C,findPreviousSiblingElement:E,getChildElements:G});D=null;function H(){if(L in D){return function(N,M){return(N[L](M)&16)!==0}}else{if("contains" in D){return function(N,M){return N!==M&&N.contains(M)}}}return function(N,M){if(N===M){return false}while(N!==M&&(M=M[I])!==null){}return N===M}}function A(O,R,P){for(var M,Q,N=O[I];N!==null;){Q=N.attributes;if(!Q||!B){return null}M=Q.getNamedItem(R);if(M&&M.specified){if(M.value===P||(P===undefined)){return N}}N=N[I]}return null}function J(O,M){M=M[F]();for(var N=O[I];N!==null;){if(N.tagName===M){return N}N=N[I]}return null}function C(N){for(var M=N.nextSibling;M!==null;M=M.nextSibling){if(M[K]===1){return M}}return null}function E(M){for(var N=M.previousSibling;N!==null;N=N.previousSibling){if(N[K]===1){return N}}return null}function G(Q){var P,O,N=[],S=Q.childNodes,M=S.length,R;N.length=M;for(P=O=0;P<M;P++){R=S[P];if(R[K]!==1){continue}N[O++]=R}N.length=O;return N}})();(function(){var A="addEventListener" in this,F=A?"target":"srcElement";APE.mixin(APE.dom.Event={},{eventTarget:F,getTarget:D,addCallback:E,removeCallback:G,preventDefault:B});function D(H){return(H||window.event)[F]}function C(I,H){return A?H:function(J){H.call(I,J)}}function E(K,J,H){if(A){K.addEventListener(J,H,false)}else{var I=C(K,H);K.attachEvent("on"+J,I)}return I||H}function G(J,I,H){if(A){J.removeEventListener(I,H,false)}else{J.detachEvent("on"+I,H)}return H}function B(H){H=H||window.event;if("preventDefault" in H){H.preventDefault()}else{if("returnValue" in H){H.returnValue=false}}}})();APE.namespace("APE.dom.Event");(function(){var C=APE.dom,A=C.Event;A.getCoords=B;function B(E){var D;if("pageX" in E){D=function(F){return{x:F.pageX,y:F.pageY}}}else{D=function(G){var F=C.getScrollOffsets();G=G||window.event;return{x:G.clientX+F.left,y:G.clientY+F.top}}}return(A.getCoords=D)(E)}})();(function(){var Q=APE.dom;Q.getStyle=D;Q.setOpacity=S;var R="getComputedStyle",E=Q.IS_COMPUTED_STYLE,P="currentStyle",O="opacity",F="style",G="px",J="filter",I="alpha("+O+"=",M=/^(?:margin|(border)(Width|Color|Style)|padding)$/,N=/\Wopacity\s*=\s*([\d]+)/i,A=/^auto|\d%$/,L="cssFloat",C=["Top","Right","Bottom","Left"];if(!(L in document.documentElement[F])){L="styleFloat"}function K(V){var X,W=V[J];if(!N.test(W)){return 1}X=N.exec(W);return X[1]/100}function S(Y,V){var X=Y[F],W;if(O in X){X[O]=V}else{if(J in X){X[J]=I+(V*100)+")";W=Y[P];if(W&&!W.hasLayout){X.zoom=1}}}}function D(W,V){var d="",a,Z,X,Y,b,c=W[Q.OWNER_DOCUMENT];if(/float/.test(V)){V=L}if(E){a=c.defaultView[R](W,"");if(!(V in a)){return""}d=a[V];if(d===""){d=T(a,V).join(" ")}if(V=="zIndex"&&d=="normal"){return"0"}if(A.test(d)){d=U(W,V)}}else{a=W[P];if(V===O){d=K(a)}else{d=a[V];if(A.test(d)){d=U(W,V)}else{if(!(V in a)){return""}}}Z=H.exec(d);if(Z){X=d.split(" ");X[0]=B(W,Z[0]);for(Y=1,b=X.length;Y<b;Y++){Z=H.exec(X[Y]);X[Y]=B(W,Z[0])}d=X.join(" ")}}return d}function U(X,W){var d=X[F],c,Y,V,Z,b,a;if("pixelWidth" in d&&/width|height|top|left/.test(W)){Y="pixel"+(W.charAt(0).toUpperCase())+W.substring(1);c=d[Y]}if(c){return c+G}if(W==="width"){b=X.clientLeft||0;V=parseFloat(D(X,"borderRightWidth"))||b;a=parseFloat(D(X,"paddingLeft"))||0+parseFloat(D(X,"paddingRight"))||0;return X.offsetWidth-b-V-a+G}else{if(W==="height"){Z=X.clientTop||0;V=parseFloat(D(X,"borderBottomWidth"))||Z;a=parseFloat(D(X,"paddingTop"))||0+parseFloat(D(X,"paddingBottom"))||0;return X.offsetHeight-Z-V+G}else{if(W=="margin"&&X[P].position!="absolute"){c=parseFloat(D(X.parentNode,"width"))-X.offsetWidth;if(c===0){return"0px"}c="0px "+c;return c+" "+c}}}return"0"}function T(b,W){var X=M.exec(W),Z,f,a,d,e,c=true,V,Y=1;if(X&&X[0]){V=C;Z=X[1]||X[0];f=X[2]||""}else{return[""]}a=b[Z+V[0]+f];e=[a];while(Y<4){d=b[Z+V[Y]+f];c=c&&d==a;a=d;e[Y++]=d}if(c){return[a]}return e}var H=/(-?\d+|(?:-?\d*\.\d+))(?:em|ex|pt|pc|in|cm|mm\s*)/;function B(Z,a){if(Z.runtimeStyle){if(parseFloat(a)===0){return"0px"}var Y=Z[F],X=Y.left,W=Z.runtimeStyle,V=W.left;W.left=Z[P].left;Y.left=(a||0);a=Y.pixelLeft+G;Y.left=X;W.left=V;return a}}})();