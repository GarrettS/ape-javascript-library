APE.namespace("APE.dom");(function(){var b=APE.dom;APE.mixin(b,{getOffsetCoords:c,isAboveElement:F,isBelowElement:W,isInsideElement:L});var i=this.document,a,h=i.documentElement,e=Math.round,Y=Math.max,D="getComputedStyle",C="defaultView",Q=h&&h.clientWidth===0,R="clientTop" in h,P=/^h/.test(h.tagName)?"table":"TABLE",M="currentStyle" in h,T,E,f,V,S,O,G,J,A,N,g,H=i[C]&&typeof i[C][D]!="undefined",I="getBoundingClientRect",d="relative",Z="borderTopWidth",B="borderLeftWidth",K=/^(?:r|a)/,U=/^(?:a|f)/;i=h=null;function c(k,AC,AI){var AO=k[b.OWNER_DOCUMENT],AM=AO.documentElement,z=AO.body;if(!AC){AC=AO}if(!AI){AI={x:0,y:0}}if(k===AC){AI.x=AI.y=0;return AI}if(I in k){var AK=Q?z:AM,v=k[I](),u=v.left+Y(AM.scrollLeft,z.scrollLeft),s=v.top+Y(AM.scrollTop,z.scrollTop),AH,AE=AK.clientTop,l=AK.clientLeft;if(R){u-=l;s-=AE}if(AC!==AO){v=c(AC,null);u-=v.x;s-=v.y;if(R){if(Q&&AC===z){u-=l;s-=AE}else{if(AC!==AO&&AC!==AM&&AC!==z){u-=AC.clientLeft;s-=AC.clientTop}}}}if(Q&&M&&AC!=AO&&AC!==z){AH=z.currentStyle;u+=parseFloat(AH.marginLeft)||0+parseFloat(AH.left)||0;s+=parseFloat(AH.marginTop)||0+parseFloat(AH.top)||0}AI.x=u;AI.y=s;return AI}else{if(H){if(!a){X()}var q=k.offsetLeft,AJ=k.offsetTop,AF=AO[C],p=AF[D](k,"");if(p.position=="fixed"){AI.x=q+AM.scrollLeft;AI.y=AJ+AM.scrollTop;return AI}var w=AF[D](z,""),AA=!K.test(w.position),o=k,r=k.parentNode,j=k.offsetParent;for(;r&&r!==AC;r=r.parentNode){if(r!==z&&r!==AM){q-=r.scrollLeft;AJ-=r.scrollTop}if(r===j){if(r===z&&AA){}else{if(!T&&!(r.tagName===P&&S)){var n=AF[D](r,"");q+=parseFloat(n[B])||0;AJ+=parseFloat(n[Z])||0}if(r!==z){q+=j.offsetLeft;AJ+=j.offsetTop;o=j;j=r.offsetParent}}}}var t=0,AG=0,AN,AB,AL=AC===AO||AC===AM,AD,m;if(o!=AO){m=AF[D](o,"").position;AN=U.test(m);AB=AN||K.test(m)}if((o===k&&k.offsetParent===z&&!E&&AC!==z&&!(AA&&V))||(E&&o===k&&!AB)||!AA&&AB&&G&&AL){AG+=parseFloat(w.marginTop)||0;t+=parseFloat(w.marginLeft)||0}if(AC===z){AD=AF[D](AM,"");if((!AA&&((A&&!AN)||(N&&AN)))||AA&&J){AG-=parseFloat(AD.paddingTop)||0;t-=parseFloat(AD.paddingLeft)||0}if(g){if(!AB||AB&&!AA){AG-=parseFloat(AD.marginTop)||0}t-=parseFloat(AD.marginLeft)||0}}if(AA){if(O||(!AN&&!T&&AL)){AG+=parseFloat(w[Z]);t+=parseFloat(w[B])}}else{if(V){if(AL){if(!f){AG+=parseFloat(w.top)||0;t+=parseFloat(w.left)||0;if(AN&&T){AG+=parseFloat(w[Z]);t+=parseFloat(w[B])}}if(AC===AO&&!AA&&!A){if(!AD){AD=AF[D](AM,"")}AG+=parseFloat(AD.paddingTop)||0;t+=parseFloat(AD.paddingLeft)||0}}else{if(f){AG-=parseFloat(w.top);t-=parseFloat(w.left)}}if(E&&(!AB||AC===z)){AG-=parseFloat(w.marginTop)||0;t-=parseFloat(w.marginLeft)||0}}}AI.x=e(q+t);AI.y=e(AJ+AG);return AI}}}function X(){a=true;var AA=document,n=AA.body;if(!n){return}var j="marginTop",AC="position",p="padding",y="static",t="border",o=n.style,AD=o.cssText,w="1px solid transparent",k="0",r="1px",u="offsetTop",q=AA.documentElement.style,AB=q.cssText,m=AA.createElement("div"),l=m.style,v=AA.createElement(P);o[p]=o[j]=o.top=k;q.position=y;o[t]=w;l.margin=k;l[AC]=y;m=n.insertBefore(m,n.firstChild);T=(m[u]===1);o[t]=k;v.innerHTML="<tbody><tr><td>x</td></tr></tbody>";v.style[t]="7px solid";v.cellSpacing=v.cellPadding=k;n.insertBefore(v,n.firstChild);S=v.getElementsByTagName("td")[0].offsetLeft===7;n.removeChild(v);o[j]=r;o[AC]=d;E=(m[u]===1);V=n[u]===0;o[j]=k;o.top=r;f=m[u]===1;o.top=k;o[j]=r;o[AC]=l[AC]=d;G=m[u]===0;l[AC]="absolute";o[AC]=y;if(m.offsetParent===n){o[t]=w;l.top="2px";O=m[u]===1;o[t]=k;l[AC]=d;q[p]=r;o[j]=k;J=m[u]===3;o[AC]=d;A=m[u]===3;l[AC]="absolute";N=m[u]===3;q[p]=k;q[j]=r;g=m[u]===3}n.removeChild(m);o.cssText=AD||"";q.cssText=AB||""}function L(k,j){var m=c(k).y,l=c(j).y;return m+k.offsetHeight<=l+j.offsetHeight&&m>=l}function F(k,j){return(c(k).y<=c(j).y)}function W(k,j){return(c(k).y+k.offsetHeight>=c(j).y+j.offsetHeight)}})();