(function(){var U=window.APE,T=U.anim,X=U.dom,R=T.Animation.prototype,Y=R._start,K=R._end;U.anim.StyleTransition=J;function J(d,a,b,c){T.Animation.call(this,b);if(d.id){d=d.id}this.id=d;this.adapters=[];if(c){this.transition=c}this.init(a)}U.extend(T.StyleTransition,T.Animation,{_start:function(){this.style=document.getElementById(this.id).style;Y.call(this)},_end:function(){this.style=null;K.call(this)},run:function P(f){var c=0,e=this.adapters,a=e.length,d=this.style,b;while(c<a){b=e[c++];d[b.prop]=b.blendTo(f)}},init:function(j){var e=document.getElementById(this.id),m=[],k,g=window.APE,d,b,i,n=g.anim.TransitionAdapterFactory,a=n.ThresholdTransitionAdapter,l=n.ImmediateThresholdTransitionAdapter;var c=e.style,f=c.cssText,h={};for(d in j){i=j[d];if(!i){continue}if(d=="opacity"&&!("opacity" in e.style)&&("filter" in e.style)){d="alpha";e.style.zoom="1";b=X.getFilterOpacity(e)}else{b=X.getStyle(e,d)}h[d]=b}for(d in j){c[d]=j[d]}c.visibility="visible";c.display="block";for(d in j){i=j[d];if(B.test(i)){i=X.getStyle(e,d)}k=n.fromValues(d,h[d],i,e);m.push(k)}c.cssText=f;m.sort(function(p,o){return(p instanceof l?-1:1)});this.adapters=m},toString:function(){return"StyleTransitionAdapter : id=#"+this.id+"\n"+R.toString.call(this)+"\nAdapters:\n  "+this.adapters.join("\n  ")}});var B=/(^-?\d+|(?:-?\d*\.\d+))(px|em|ex|pt|pc|in|cm|mm|%)/i,D=/color/i,H=/(?:width|height|padding|fontSize)$/ig,I=/alpha/,L=/^opacity/,Q=/^\d+$/,C=/^(?:hidden|collapse)/;T.TransitionAdapterFactory={fromValues:function(d,c,b){var a;if(H.test(d)){a=this.PositiveLengthTransitionAdapter}else{if(D.test(d)){a=this.ColorTransitionAdapter}else{if(B.test(c)){a=this.LengthTransitionAdapter}else{if(I.test(d)){a=this.FilterTransitionAdapter}else{if(L.test(d)){a=this.OpacityTransitionAdapter}else{if(d=="fontWeight"&&Q.test(c)&&Q.test(b)){a=this.FontWeightTransitionAdapter}else{if(d==="visibility"&&C.test(c)||d=="display"&&c=="none"){a=this.ImmediateThresholdTransitionAdapter}else{a=this.ThresholdTransitionAdapter}}}}}}}return new a(d,c,b)}};var S=U.color&&U.color.ColorRGB,Z={PositiveLengthTransitionAdapter:G,ColorTransitionAdapter:W,LengthTransitionAdapter:V,FilterTransitionAdapter:E,OpacityTransitionAdapter:F,FontWeightTransitionAdapter:M,ThresholdTransitionAdapter:O,ImmediateThresholdTransitionAdapter:A};U.mixin(T.TransitionAdapterFactory,Z);function N(d,c,a,b){this.prop=d;this.fromValue=c;this.toValue=a;if(b){this.units=b}}N.prototype.toString=function(){var a=(this.units||"");return U.getFunctionName(this.constructor)+": "+this.prop+", "+this.fromValue.toString()+a+" \u2014 "+this.toValue.toString()+a};function W(e,d,a){if(!S){S=U.color.ColorRGB}var c=S.fromString(d),b=a=S.fromString(a);N.call(this,e,c,b);this.currentValue=new S()}U.extend(W,N,{blendTo:function(a){var b=S.blend(this.fromValue,this.toValue,a,this.currentValue);return b.toString()}});function V(c,b,a){N.call(this,c,parseFloat(b),parseFloat(a),"px")}U.extend(V,N);V.prototype.blendTo=function(b){var a=1-b;return((this.fromValue*a)+(this.toValue*b))+this.units};function G(){V.apply(this,arguments)}U.extend(G,V);G.prototype.blendTo=function(c){var a=1-c,b=Math.max((this.fromValue*a)+(this.toValue*c),0)+this.units;return b};function F(c,b,a){N.call(this,c,parseFloat(b),parseFloat(a))}U.extend(F,N);F.prototype.blendTo=function(c){var a=1-c,b=Math.max((this.fromValue*a)+(this.toValue*c),0);return b};function E(c,b,a){N.call(this,"filter",b,a)}U.extend(E,N);E.prototype.blendTo=function(c){var a=1-c,b=Math.abs((this.fromValue*a)+(this.toValue*c),0);return"alpha(opacity="+Math.abs(b*100)+")"};function M(c,b,a){N.call(this,c,parseInt(b),parseInt(a))}U.extend(M,N);M.prototype.blendTo=function(c){var a=1-c,b=(((this.fromValue*a)+(this.toValue*c))/100<<0)*100;if(b<100){return 100}if(b>900){return 900}return b};function O(c,b,a){N.call(this,c,b,a)}U.extend(O,N);O.prototype.blendTo=function(a){if(a===1){return this.toValue}return this.fromValue};function A(c,b,a){N.call(this,c,b,a)}U.extend(A,N);A.prototype.blendTo=function(a){if(a===0){return this.fromValue}return this.toValue}})();