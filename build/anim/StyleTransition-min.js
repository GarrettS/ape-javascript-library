(function(){var U=window.APE,T=U.anim,Y=U.dom,R=T.Animation.prototype,Z=R._start,K=R._end;U.anim.StyleTransition=J;function J(e,b,c,d){T.Animation.call(this,c);if(e.id){e=e.id}this.id=e;this.adapters=[];if(d){this.transition=d}this.init(b)}U.extend(T.StyleTransition,T.Animation,{_start:function(){this.style=document.getElementById(this.id).style;Z.call(this)},_end:function(){this.style=null;K.call(this)},run:function P(g){var d=0,f=this.adapters,b=f.length,e=this.style,c;while(d<b){c=f[d++];e[c.prop]=c.blendTo(g)}},init:function(j){var e=document.getElementById(this.id),m=[],k,g=window.APE,c,i,d=e.style,f=d.cssText,h={},n=T.TransitionAdapterFactory,b=n.ThresholdTransitionAdapter,l=n.ImmediateThresholdTransitionAdapter;for(c in j){if(!j[c]){continue}if(c=="opacity"&&!("opacity" in d)&&("filter" in d)&&!d.hasLayout){d.zoom="1"}h[c]=Y.getStyle(e,c)}X(e,j);for(c in j){i=j[c];if(B.test(i)){i=Y.getStyle(e,c)}k=n.fromValues(c,h[c],i,e);m.push(k)}d.cssText=f;m.sort(function(p,o){return(p instanceof l?-1:1)});this.adapters=m},toString:function(){return"StyleTransitionAdapter : id=#"+this.id+"\n"+R.toString.call(this)+"\nAdapters:\n  "+this.adapters.join("\n  ")}});function X(e,c){var f,b,d=e.style;for(f in c){b=c[f];if(f==="opacity"){Y.setOpacity(e,b)}else{d[f]=b}}d.visibility="visible";d.display="block"}var B=/(^-?\d+|(?:-?\d*\.\d+))(px|em|ex|pt|pc|in|cm|mm|%)/i,D=/color/i,H=/(?:width|height|padding|fontSize)$/ig,I=/alpha/,L=/^opacity/,Q=/^\d+$/,C=/^(?:hidden|collapse)/;T.TransitionAdapterFactory={fromValues:function(e,d,c){var b;if(H.test(e)){b=this.PositiveLengthTransitionAdapter}else{if(D.test(e)){b=this.ColorTransitionAdapter}else{if(B.test(d)){b=this.LengthTransitionAdapter}else{if(I.test(e)){b=this.FilterTransitionAdapter}else{if(L.test(e)){b=this.OpacityTransitionAdapter}else{if(e=="fontWeight"&&Q.test(d)&&Q.test(c)){b=this.FontWeightTransitionAdapter}else{if(e==="visibility"&&C.test(d)||e=="display"&&d=="none"){b=this.ImmediateThresholdTransitionAdapter}else{b=this.ThresholdTransitionAdapter}}}}}}}return new b(e,d,c)}};var S=U.color&&U.color.ColorRGB,a={PositiveLengthTransitionAdapter:G,ColorTransitionAdapter:W,LengthTransitionAdapter:V,FilterTransitionAdapter:E,OpacityTransitionAdapter:F,FontWeightTransitionAdapter:M,ThresholdTransitionAdapter:O,ImmediateThresholdTransitionAdapter:A};U.mixin(T.TransitionAdapterFactory,a);function N(e,d,b,c){this.prop=e;this.fromValue=d;this.toValue=b;if(c){this.units=c}}N.prototype.toString=function(){var b=(this.units||"");return U.getFunctionName(this.constructor)+": "+this.prop+", "+this.fromValue.toString()+b+" \u2014 "+this.toValue.toString()+b};function W(g,e,b){if(!S){S=U.color.ColorRGB}var d=S.fromString(e),c=b=S.fromString(b);N.call(this,g,d,c);this.currentValue=new S()}U.extend(W,N,{blendTo:function(b){var d=S.blend(this.fromValue,this.toValue,b,this.currentValue);return d.toString()}});function V(d,c,b){N.call(this,d,parseFloat(c),parseFloat(b),"px")}U.extend(V,N);V.prototype.blendTo=function(c){var b=1-c;return((this.fromValue*b)+(this.toValue*c))+this.units};function G(){V.apply(this,arguments)}U.extend(G,V);G.prototype.blendTo=function(d){var b=1-d,c=Math.max((this.fromValue*b)+(this.toValue*d),0)+this.units;return c};function F(d,c,b){N.call(this,d,parseFloat(c),parseFloat(b))}U.extend(F,N);F.prototype.blendTo=function(d){var b=1-d,c=Math.max((this.fromValue*b)+(this.toValue*d),0);return c};function E(d,c,b){N.call(this,"filter",c,b)}U.extend(E,N);E.prototype.blendTo=function(d){var b=1-d,c=Math.abs((this.fromValue*b)+(this.toValue*d),0);return"alpha(opacity="+Math.abs(c*100)+")"};function M(d,c,b){N.call(this,d,parseInt(c),parseInt(b))}U.extend(M,N);M.prototype.blendTo=function(d){var b=1-d,c=(((this.fromValue*b)+(this.toValue*d))/100<<0)*100;if(c<100){return 100}if(c>900){return 900}return c};function O(d,c,b){N.call(this,d,c,b)}U.extend(O,N);O.prototype.blendTo=function(b){if(b===1){return this.toValue}return this.fromValue};function A(d,c,b){N.call(this,d,c,b)}U.extend(A,N);A.prototype.blendTo=function(b){if(b===0){return this.fromValue}return this.toValue}})();