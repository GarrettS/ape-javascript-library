APE.anim.StyleTransition=function(D,A,B,C){APE.anim.Animation.call(this,B);if(D.id){D=D.id}this.id=D;this.adapters=[];this.style=document.getElementById(D).style;if(C){this.transition=C}this.init(A)};APE.extend(APE.anim.StyleTransition,APE.anim.Animation,{inited:false,run:function run(E){var C=0,D=this.adapters,A=D.length,B;while(C<A){B=D[C++];this.style[B.prop]=B.blendTo(E)}},init:function(J){if(this.inited){return}var D=document.getElementById(this.id),M=[],K,E=window.APE,C,H,B,G,F=E.dom,I=E.anim.TransitionAdapterFactory,A=I.ThresholdTransitionAdapter,L=I.ImmediateThresholdTransitionAdapter;for(C in J){G=J[C];if(!G){continue}if(C=="opacity"&&!("opacity" in this.style)&&("filter" in this.style)){C="alpha";this.style.zoom="1";B=F.getFilterOpacity(D)}else{H=F.getStyleUnit(G);B=F.findInheritedStyle(D,C,H)}K=I.fromValues(C,B,G);M.push(K)}M.sort(function(O,N){return(O instanceof L?-1:1)});this.adapters=M},toString:function(){return"StyleTransitionAdapter : id=#"+this.id+"\n"+APE.anim.Animation.prototype.toString.call(this)+"\nAdapters:\n  "+this.adapters.join("\n  ")}});APE.anim.TransitionAdapterFactory={lengthExp:/(^-?\d+|(?:-?\d*\.\d+))(px|em|ex|pt|pc|in|cm|mm|%)/i,colorExp:/color/i,positiveLengthExp:/(?:width|height|padding|fontSize)$/ig,filterExp:/alpha/,opacityExp:/^opacity/,intExp:/^\d+$/,noVisibilityExp:/^(?:hidden|collapse)/,fromValues:function(C,B,A){if(this.positiveLengthExp.test(C)){return new this.PositiveLengthTransitionAdapter(C,B,A)}if(this.colorExp.test(C)){return new this.ColorTransitionAdapter(C,B,A)}if(this.lengthExp.test(B)){return new this.LengthTransitionAdapter(C,B,A)}if(this.filterExp.test(C)){return new this.FilterTransitionAdapter(C,B,A)}if(this.opacityExp.test(C)){return new this.OpacityTransitionAdapter(C,B,A)}if(C=="fontWeight"&&this.intExp.test(B)&&this.intExp.test(A)){return new this.FontWeightTransitionAdapter(C,B,A)}if(C=="visibility"&&this.noVisibilityExp.test(B)||C=="display"&&B=="none"){return new this.ImmediateThresholdTransitionAdapter(C,B,A)}return new this.ThresholdTransitionAdapter(C,B,A)}};(function(){var D=window.APE,B=D.color&&D.color.ColorRGB,H={PositiveLengthTransitionAdapter:G,ColorTransitionAdapter:E,LengthTransitionAdapter:L,FilterTransitionAdapter:I,OpacityTransitionAdapter:C,FontWeightTransitionAdapter:M,ThresholdTransitionAdapter:A,ImmediateThresholdTransitionAdapter:K};D.mixin(D.anim.TransitionAdapterFactory,H);function F(Q,P,N,O){this.prop=Q;this.fromValue=P;this.toValue=N;if(O){this.units=O}}F.prototype.toString=function(){var N=(this.units||"");return D.getFunctionName(this.constructor)+": "+this.prop+", "+this.fromValue.toString()+N+" \u2014 "+this.toValue.toString()+N};function E(R,Q,N){if(!B){B=D.color.ColorRGB}var P=B.fromString(Q),O=N=B.fromString(N);F.call(this,R,P,O);this.currentValue=new B()}D.extend(E,F,{blendTo:function(N){var O=B.blend(this.fromValue,this.toValue,N,this.currentValue);return O.toString()}});function L(S,R,N){var O=D.anim.TransitionAdapterFactory.lengthExp,Q=O.exec(R),P=O.exec(N);F.call(this,S,parseFloat(Q[0]),parseFloat(P[0]),Q[2])}D.extend(L,F);L.prototype.blendTo=function(O){var N=1-O;return((this.fromValue*N)+(this.toValue*O))+this.units};function G(){L.apply(this,arguments)}D.extend(G,L);G.prototype.blendTo=function(P){var N=1-P,O=Math.max((this.fromValue*N)+(this.toValue*P),0)+this.units;return O};var J=/0(\s|\))/g;function C(P,O,N){F.call(this,P,parseFloat(O),parseFloat(N))}D.extend(C,F);C.prototype.blendTo=function(P){var N=1-P,O=Math.max((this.fromValue*N)+(this.toValue*P),0);return O};function I(P,O,N){F.call(this,"filter",O,N)}D.extend(I,F);I.prototype.blendTo=function(P){var N=1-P,O=Math.abs((this.fromValue*N)+(this.toValue*P),0);return"alpha(opacity="+Math.abs(O*100)+")"};function M(P,O,N){F.call(this,P,parseInt(O),parseInt(N))}D.extend(M,F);M.prototype.blendTo=function(P){var N=1-P,O=(((this.fromValue*N)+(this.toValue*P))/100<<0)*100;if(O<100){return 100}if(O>900){return 900}return O};function A(P,O,N){F.call(this,P,O,N)}D.extend(A,F);A.prototype.blendTo=function(N){if(N==1){return this.toValue}return this.fromValue};function K(P,O,N){F.call(this,P,O,N)}D.extend(K,F);K.prototype.blendTo=function(N){if(N==0){return this.fromValue}return this.toValue}})();