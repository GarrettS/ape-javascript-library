APE.namespace("APE.anim");
(function(){function C(b){if(typeof b=="number")this.duration=b*1E3;this.timeLimit=this.duration}function v(b){return b}APE.anim.Animation=C;var g="rationalValue";C.prototype={paused:false,duration:1E3,timeLimit:1E3,isReversed:false,startOffset:0,endOffset:1,startValue:0,endValue:1,rationalValue:0,transition:v,position:0,onstart:v,onend:v,onabort:function(b){throw b;},run:v,start:function(){if(!this.paused){this.playing=true;this.timeLimit=this.duration;this.endOffset=this.transition(this.endValue);this._start()}},
startAfter:function(b){function h(){m.start();clearTimeout(this.startAfterTimer);delete m.startAfterTimer}var m=this;m.startAfterTimer=setTimeout(h,b)},_start:function(){o.unregister(this);this._startTime=+new Date;this.onstart();o.register(this);this.started=true;clearTimeout(this.startAfterTimer);delete this.startAfterTimer},seekTo:function(b,h){b=parseFloat(b);if(isFinite(b))if(b!==this[g]){this.startOffset=this.position;this.startValue=this[g];this.endValue=b;var m=Math.abs(b-this.startValue);
this.timeLimit=this.duration*m;this.endOffset=(this._transitionBackwards=(this.isReversed=b<this[g])&&h)?1-this.transition(1-b):this.transition(b);this._start()}},toggleDirection:function(){if(this.started)this.isReversed?this.seekTo(1):this.seekTo(0,this.position==1);else this.start()},reset:function(){this.position=0;this.timeLimit=this.duration},pause:function(){this.paused=true;this.elapsedTime=new Date-this._startTime;o.unregister(this)},resume:function(){this.paused=false;this._startTime=new Date-
this.elapsedTime;o.register(this)},toString:function(){return"Animation {duration millis: "+this.duration+", position:"+this.position+"}"},stop:function(b){clearTimeout(this.startAfterTimer);delete this.startAfterTimer;this._end(b)},abort:function(b){o.unregister(this);this.onabort(b||{})},_end:function(b){o.unregister(this);b!==false&&this.onend()}};var o=new (function(){function b(d){l.length===0&&m.call(this);for(var f=0;f<l.length;f++)if(l[f]===d)return;l.push(d)}function h(d){for(var f=0;f<l.length;f++)l[f]===
d&&l.splice(f,1);if(l.length===0){l=[];j.call(this)}}function m(){y=self.setInterval(z,D)}function z(){for(var d=0,f;d<l.length;d++)try{f=l[d];F(f)}catch(p){f&&f.abort(p)}}function j(){self.clearInterval(y)}function F(d){var f=new Date-d._startTime;if(f>=d.timeLimit){d.run(d.position=d.endOffset);d[g]=d.endValue;d._end()}else{f=f/d.duration;var p=d.transition;if(d.isReversed){d[g]=d.startValue-f;d.position=d._transitionBackwards?1-p(1-d[g]):p(d[g])}else{d[g]=d.startValue+f;d.position=p(d[g])}typeof d.onplay==
"function"&&d.onplay(d.position);d.run(d.position)}}this.register=b;this.unregister=h;var D=17,l=[],y}),n=Math.PI,w=Math.atan,x=Math.cos;APE.anim.Transitions={none:v,accel:function(b){return b*b*b},decel:function(b){b=1-b;return 1-b*b*b},reverse:function(b){return 1-b},getSigmoid:function(b){function h(m){return(w(b*(2*m-1))/w(b)+1)/2}b=b||1;return h},easeInEaseOut:function(b){return(w(b*n/1-n/2)+1)/2.0038848218538874},wobble:function(b){return-x(3*b*n)/2+0.5},loop:function(b){return-x(2*b*n)/2+0.5},
spring:function(b){return 1-x(b*4.5*n)*Math.exp(-b*6)},swingTo:function(b){var h=1.70158;return(b-=1)*b*((h+1)*b+h)+1},swingToFrom:function(b){var h=1.70158;if((b/=0.5)<1)return 0.5*b*b*(((h*=1.525)+1)*b-h);return 0.5*((b-=2)*b*(((h*=1.525)+1)*b+h)+2)}}})();
(function(){function C(a,c,e,i){D.call(this,e);if(a.id)a=a.id;this.id=a;if(i)this.transition=i;this.init(c)}function v(a,c){var e,i,k=a[A];for(e in c){i=c[e];if(e===p)y.setOpacity(a,i);else k[e]=i}k.visibility="visible";k.display="block"}function g(a,c,e){this.prop=a;this[f]=c;this[q]=e}function o(a,c,e){if(!B)B=j.color.ColorRGB;c=B.fromString(c);e=B.fromString(e);g.call(this,a,c,e);this.currentValue=new B}function n(a,c,e){g.call(this,a,parseFloat(c),parseFloat(e))}function w(){n.apply(this,arguments)}
function x(a,c,e){g.call(this,a,parseFloat(c),parseFloat(e))}function b(a,c,e){g.call(this,"filter",c,e)}function h(a,c,e){g.call(this,a,parseInt(c,10),parseInt(e,10))}function m(a,c,e){g.call(this,a,c,e)}function z(a,c,e){g.call(this,a,c,e)}var j=window.APE,F=j.anim,D=F.Animation,l=D.prototype,y=j.dom,d,f="fromValue",p="opacity",q="toValue",G="px",r="prototype",s="blendTo",E="toString",t="extend",A="style";F.StyleTransition=C;j[t](C,D,{_start:function(){this[A]=document.getElementById(this.id)[A];
l._start.call(this)},_end:function(){this[A]=null;l._end.call(this)},run:function(a){for(var c=0,e=this.adapters,i=e.length,k=this[A],u;c<i;){u=e[c++];k[u.prop]=u[s](a)}},init:function(a){var c=document.getElementById(this.id),e=[],i,k,u=c[A],K=u.cssText,H={};if(d===undefined)d=!(p in u)&&"filter"in u;for(k in a)if(a[k]){if(k===p&&d&&!c.currentStyle.hasLayout)u.zoom="1";H[k]=y.getStyle(c,k)}v(c,a);for(k in a){i=a[k];if(I.test(i))i=y.getStyle(c,k);i=L.fromValues(k,H[k],i);e.push(i)}u.cssText=K;e.sort(function(M){return M instanceof
z?-1:1});this.adapters=e},toString:function(){return"StyleTransitionAdapter : id=#"+this.id+"\n"+l[E].call(this)+"\nAdapters:\n  "+this.adapters.join("\n  ")}});var I=/(^-?\d+|(?:-?\d*\.\d+))(px|em|ex|pt|pc|in|cm|mm|%)/i,N=/color/i,O=/(?:width|height|padding|fontSize)$/ig,J=/^\d+$/,P=/^(?:hidden|collapse)/,L={fromValues:function(a,c,e){var i;i=O.test(a)?w:N.test(a)?o:I.test(c)?n:a===p?d?b:x:a=="fontWeight"&&J.test(c)&&J.test(e)?h:a==="visibility"&&P.test(c)||a=="display"&&c=="none"?z:m;return new i(a,
c,e)}},B=j.color&&j.color.ColorRGB;g[r][E]=function(){return"Transition: "+this.prop+", "+this[f][E]()+" \u2014 "+this[q][E]()};j[t](o,g);o[r][s]=function(a){a=B.blend(this[f],this[q],a,this.currentValue);return a[E]()};j[t](n,g);n[r][s]=function(a){var c=1-a;return this[f]*c+this[q]*a+G};j[t](w,n);w[r][s]=function(a){var c=1-a;return a=Math.max(this[f]*c+this[q]*a,0)+G};j[t](x,g);x[r][s]=function(a){var c=1-a;return a=Math.max(this[f]*c+this[q]*a,0)};j[t](b,g);b[r][s]=function(a){var c=1-a;a=Math.abs(this[f]*
c+this[q]*a,0);return"alpha(opacity="+Math.abs(a*100)+")"};j[t](h,g);h[r][s]=function(a){var c=1-a;a=((this[f]*c+this[q]*a)/100<<0)*100;if(a<100)return 100;if(a>900)return 900;return a};j[t](m,g);m[r][s]=function(a){if(a===1)return this[q];return this[f]};j[t](z,g);z[r][s]=function(a){if(a===0)return this[f];return this[q]}})();
