APE.namespace("APE.anim");APE.anim.Animation=function(A){if(typeof A=="number"){this.duration=A*1000}this.timeLimit=this.duration};APE.anim.Animation.prototype={paused:false,duration:1000,timeLimit:1000,isReversed:false,startOffset:0,endOffset:1,startValue:0,endValue:1,rationalValue:0,transition:function(A){return A},position:0,onstart:function(){},onend:function(){},onabort:function(A){throw A},run:function(){},start:function(){if(this.paused){return}this.playing=true;this.timeLimit=this.duration;this.endOffset=this.transition(this.endValue);this._start()},_start:function(){APE.anim.Manager.unregister(this);this._startTime=new Date-0;this.onstart();APE.anim.Manager.register(this);this.started=true},seekTo:function(C,A){C=parseFloat(C);if(!isFinite(C)){return}if(C===this.rationalValue){return}this.startOffset=this.position;this.startValue=this.rationalValue;this.endValue=C;var B=Math.abs(C-this.startValue);this.timeLimit=this.duration*B;this.isReversed=(C<this.rationalValue);this._transitionBackwards=this.isReversed&&A;if(this._transitionBackwards){this.endOffset=1-this.transition(1-C)}else{this.endOffset=this.transition(C)}this._start()},toggleDirection:function(){if(!this.started){this.start();return}if(this.isReversed){this.seekTo(1)}else{this.seekTo(0,this.position==1)}},reset:function(){this.position=0;this.timeLimit=this.duration},pause:function(){this.paused=true;this.elapsedTime=new Date-this._startTime;APE.anim.Manager.unregister(this)},resume:function(){this.paused=false;this._startTime=new Date-this.elapsedTime;APE.anim.Manager.register(this)},_playFrame:function(){var A=new Date-this._startTime;if(A>=this.timeLimit){this.run(this.position=this.endOffset);this.rationalValue=this.endValue;this._end();return}var B=(A/this.duration);if(this.isReversed){this.rationalValue=this.startValue-B;if(this._transitionBackwards){this.position=1-this.transition(1-this.rationalValue)}else{this.position=this.transition(this.rationalValue)}}else{this.rationalValue=this.startValue+B;this.position=this.transition(this.rationalValue)}if(typeof this.onplay=="function"){this.onplay(this.position)}this.run(this.position)},toString:function(){return"Animation {duration millis: "+this.duration+", position:"+this.position+"}"},stop:function(A){this._end(A)},abort:function(A){APE.anim.Manager.unregister(this);this.onabort(A||{})},_end:function(A){APE.anim.Manager.unregister(this);if(A!==false){this.onend()}}};APE.anim.Manager=new function(){this.register=E;this.unregister=C;var A=[],F;function E(J){if(A.length===0){H.call(this)}for(var I=0;I<A.length;I++){if(A[I]===J){return}}A.push(J)}function C(J){for(var I=0;I<A.length;I++){if(A[I]===J){A.splice(I,1)}}if(A.length==0){A=[];B.call(this)}}this.toString=function(){return"APE.anim.Manager : activeAnimations:\n"+A.join("\n ")};var D;function H(){D=new Date;var I=17;F=window.setInterval(G,I)}function G(){var J=0,K;for(;J<A.length;J++){K=A[J];try{K._playFrame()}catch(I){K.abort(I)}}}function B(){window.clearInterval(F)}};APE.anim.Transitions={none:function(A){return A},accel:function(A){return A*A*A},decel:function(A){A=1-A;return 1-(A*A*A)},reverse:function(A){return 1-A},sigmoid:function(C,A){var B=Math.atan;A=A||1;return(B(A*(2*C-1))/B(A)+1)/(2)},sigmoid2:function(B){var A=Math.atan;return(A(2*(2*B-1))/A(2)+1)/(2)},sigmoid3:function(B){var A=Math.atan;return(A(3*(2*B-1))/A(3)+1)/(2)},sigmoid4:function(B){var A=Math.atan;return(A(4*(2*B-1))/A(4)+1)/(2)},tan:function(B){var A=Math.tan;return(A(1*(2*B-1))/A(1)+1)/(2)},reverseWarp:function(B){var A=Math.tan;return(A(2*(2*B-1))/A(2)+1)/(2)},easeInEaseOut:function(B){var A=Math.PI;return(Math.atan(B*A/1-A/2)+1)/2.0038848218538874},wobble:function(A){return(-Math.cos(3*A*Math.PI)/2)+0.5},loop:function(A){return(-Math.cos(2*A*Math.PI)/2)+0.5},spring:function(A){return 1-(Math.cos(A*4.5*Math.PI)*Math.exp(-A*6))},swingTo:function(B){var A=1.70158;return(B-=1)*B*((A+1)*B+A)+1},swingToFrom:function(B){var A=1.70158;if((B/=0.5)<1){return 0.5*(B*B*(((A*=(1.525))+1)*B-A))}return 0.5*((B-=2)*B*(((A*=(1.525))+1)*B+A)+2)},toString:function(){return"APE anim Transitions"}};