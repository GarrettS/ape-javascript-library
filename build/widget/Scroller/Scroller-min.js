APE.namespace("APE.widget");(function(){var C=self.APE,D=C.widget,E=C.dom;D.Scroller=C.createFactory(A,B);function A(H,G,F){this.id=H;this.timeDuration=G||250;this.isVertical=!!F;this._queue=0;this.init()}function B(){function F(L){return K;function K(){G(L)}}function I(){var L=this.id.match(/(\w+)(Next|Prev)$/),K=D.Scroller.getById(L[1]);H(K,L[2]==="Next")}function H(K,O){if(K.timerId){K._queue+=O?1:-1;return}var P=document,R=K.id,Q=P.getElementById(R+"Frame")[K.clientDimension],N,L;if(K.scrollDistance<=Q){return}K.style=P.getElementById(R).style;if(O){Q=-Q}K.newPos=K.pos+Q;N=P.getElementById(R+"Prev");L=P.getElementById(R+"Next");if(!O){E.removeClass(L,"scrollerButton-disabled");if(K.newPos>=0){Q=-K.pos;K.newPos=0;E.addClass(N,"scrollerButton-disabled")}}else{if(K.pos===0&&K.newPos){E.removeClass(N,"scrollerButton-disabled")}if(K.newPos<=K.frameSize-K.scrollDistance){E.addClass(L,"scrollerButton-disabled");var M=K.scrollDistance+K.pos-K.frameSize;Q=-M;K.newPos=K.pos-M}}K.startTime=+new Date;K.startPos=K.pos;K.dx=Q;K.timerId=self.setInterval(F(K),12)}function G(K){var L=new Date-K.startTime,N=L/K.timeDuration,M=(Math.atan(1.4*(2*N-1))/Math.atan(1.4)+1)/2;if(N>=1){return J(K)}K.style[K.stylePos]=(K.pos=0|K.startPos+K.dx*M)+"px"}function J(K){K.timerId=self.clearInterval(K.timerId);K.style[K.stylePos]=(K.pos=K.newPos)+"px";if(K._queue!==0){var L=K._queue>0;K._queue+=L?-1:1;H(K,L)}else{if(typeof K.onend=="function"){K.onend()}K.style=null}}return{pos:0,init:function(){var T=document,K=this.id,L=T.getElementById(K),U,Q=L.childNodes,O,P,R=E.Event.addCallback,S=this.isVertical,N=S?"offsetTop":"offsetLeft",V=S?"offsetHeight":"offsetWidth",M=T.getElementById(K+"Prev");next=T.getElementById(K+"Next");this.clientDimension=S?"clientHeight":"clientWidth";this.stylePos=S?"top":"left";for(O=0,P=Q.length;O<P;O++){U=Q[O];if(!U){break}if(!/LI/i.test(U.tagName)){U.parentNode.removeChild(U)}}this.scrollDistance=L.lastChild[N]+L.lastChild[V];this.frameSize=L.parentNode[this.clientDimension];L.style[S?"height":"width"]=this.scrollDistance+10+"px";if(M!==null){R(M,"click",I)}if(next!==null){R(next,"click",I)}},next:function(){H(this,true);return this},prev:function(){H(this,false);return this}}}})();