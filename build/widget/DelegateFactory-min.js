APE.namespace("APE.widget").DelegateFactory={descendantMatcher:function(D,F){var A,G,C,E=this.cbMap,B=APE.dom.contains;for(G in E){A=E[G];C=document.getElementById(G);if(B(C,F)){return G}}return null},create:function(F,M,B,G){var D=window.APE,C=D.widget.DelegateFactory;function I(S,U,R,T){this.factory=S;this.eventRegistry=U;this.getMatch=T||L;this.eventTypeList=R;this.cbMap={}}C.create=Q;return C.create(F,M,B,G);function Q(S,U,R,T){if(typeof R==="string"){R=[R]}S.delegateFactory=new I(S,U,R,T);S.addDelegateFor=O;S.removeDelegateFor=H;S.removeAllDelegates=J;return S}function L(R,S){var T=S.id;return(T in this.cbMap)?T:null}function A(T){var U,R,V=document.documentElement,S=K(T);for(U=0,R=T.eventTypeList.length;U<R;U++){T.eventRegistry.add(V,T.eventTypeList[U],S)}return S}function J(){var V=this.delegateFactory,S,R,U,T=document.documentElement;for(S=0,R=V.eventTypeList.length;S<R;S++){V.eventRegistry.remove(T,V.eventTypeList[S],V.delegateCallback)}delete V.delegateCallback}function H(R){if(typeof R.id==="string"){R=R.id}P(this.delegateFactory,R)}function P(S,R){delete S.cbMap[R];if(E(S.cbMap)){S.factory.removeAllDelegates();delete S.delegateCallback}}function E(S){return(E=D.__count__?function(T){return R(T)&&T.__count__===0}:typeof Object.keys==="function"?function(T){return R(T)&&Object.keys(T).length===0}:function(U){if(R(U)){for(var T in U){return true}}return false})(S);function R(T){return typeof T=="object"&&T!==null}}function O(T,R){var S=this.delegateFactory;S.cbMap[T]=R?{id:T,config:R}:T;if(!S.delegateCallback){S.delegateCallback=A(S)}}function K(R){return R.delegateCallback||(R.delegateCallback=function(S){N(S,R)})}function N(S,V){var T=D.dom.Event.getTarget(S),U=V.getMatch(S,T),R,W="getByNode";if(U){if(typeof U==="string"){W="getById";R=(V.cbMap[U]||0).config}V.factory[W](U,R&&R);P(V,U)}}}};