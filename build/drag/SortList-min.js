(function(){function k(a,d){this.id=a;a=document.getElementById(a);a.onmousedown=l;this.dragOptions=d}function l(a){a=g.Event.getTarget(a);if(a=a.tagName==="LI"?a:g.findAncestorWithTagName(a,"LI")){a=m.getByNode(a,n.getById(this.id).dragOptions);a.ondragend=o}}function o(a){var d=this.el,e=g.Event.getCoords(a.domEvent),f=a.draggableList;a=d.parentNode;var b,c=[],h=0;g.addClass(a,"hiddenSelection");e=p(a,f,e.y);for(b in f){d=f[b].el;d.style.top="";c[h++]=d}h>1&&c.sort(i);for(d=0;d<c.length;d++)a.insertBefore(c[d],
e);g.removeClass(a,"hiddenSelection")}function p(a,d,e){var f=a.getElementsByTagName("li"),b,c,h=g.getOffsetCoords(a).y;for(c=0;c<f.length;c++){a=f[c];b=a.id;if(!b||!(b in d)){b=g.getOffsetCoords(a).y;if(b+h>e)return a}}return null}var g=APE.dom,j=APE.drag,n=j.SortList=APE.createFactory(k),m=j.Draggable;function i(a,d){var e=document.documentElement,f;f=typeof e.sourceIndex=="number"?function(b,c){return b.sourceIndex-c.sourceIndex}:"compareDocumentPosition"in e?function(b,c){return c.compareDocumentPosition(b)-
3}:function(b,c){for(b=b.nextSibling;b!==null;b=b.nextSibling)if(b==c)return-1;return 1};e=null;return(i=f)(a,d)}})();
