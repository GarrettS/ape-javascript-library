APE.drag.defineFactory("SortList",function(B){var E=APE.dom,F=APE.drag,D=F.Draggable;function A(L,J){this.id=L;var K=document.getElementById(L);K.onmousedown=G;this.dragOptions=J}function G(K){var M=E.Event.getTarget(K),J=M.tagName==="LI"?M:E.findAncestorWithTagName(M,"LI"),L;if(J){L=D.getByNode(J,B.getById(this.id).dragOptions);L.ondragend=I}}function I(R){var M=this.el,S=E.Event.getCoords(R.domEvent),Q=R.draggableList,N=M.parentNode,K,L,O,J=[],P=0;E.addClass(N,"hiddenSelection");L=C(N,Q,S.y);for(K in Q){M=Q[K].el;M.style.top="";J[P++]=M}if(P>1){J.sort(H)}for(O=0;O<J.length;O++){N.insertBefore(J[O],L)}E.removeClass(N,"hiddenSelection")}function C(M,N,O){var Q=M.getElementsByTagName("li"),P,J,L,K,R=E.getOffsetCoords(M).y;for(L=0;L<Q.length;L++){P=Q[L];K=P.id;if(!K||!(K in N)){J=E.getOffsetCoords(P).y;if(J+R>O){return P}}}return null}var H=function(K,J){var L=document.documentElement,M;if(typeof L.sourceIndex=="number"){M=function(O,N){return O.sourceIndex-N.sourceIndex}}else{if("compareDocumentPosition" in L){M=function(O,N){return N.compareDocumentPosition(O)-3}}else{M=function(O,N){for(var P=O.nextSibling;P!==null;P=P.nextSibling){if(P==N){return -1}}return 1}}}L=null;return(H=M)(K,J)};return A});