APE.namespace("APE.form").Form=function(A){this.form=A};APE.form.Form.prototype=function(){function A(C,G){var F,D=C.options,E,B;if(C.multiple){for(E=0,B=D.length;E<B;E++){F=D[E];if(F.selected){G.push(F.value||F.text)}}}else{F=D[C.selectedIndex];if(!F.disabled){G.push(F.value||F.text)}}}return{toObject:function(L){var E=this.form,B=E.elements,H,K,I,N,C,F=/^(?:rad|che)/,P={},D,M,J=E.tagName,O=J.indexOf("f")===0?"toUpperCase":"toString",G=/^(?:submit|image)$/;if(!B&&J[O]()==="FIELDSET"){E=E.form;M=true;B=E.elements}for(H=0,K=B.length;H<K;H++){if(M&&!APE.dom.contains(E,B[H])){continue}I=B[H];N=I.type;C=I.name;if(!C||I.disabled||N=="reset"||N=="button"||G.test(N)||(F.test(N)&&!I.checked)||(I.tagName[O]()==="OBJECT"&&I.declare)){continue}D=P[C];if(!D){P[C]=D=[]}if(I.id=="back"){alert(I.options)}if(I.options){if(!A(I,D)&&D.length==0){delete P[C]}}else{if(I.type=="file"){}else{D[D.length]=I.value}}}if(L&&L.name&&!L.disabled){if(!P[L.name]){D=P[L.name]=[]}D[D.length]=L.value}return P},getMultipartFormData:function(D){var I=this.toObject(D),B,G,C,E,F,J=[],H="\r\n\r\n";for(B in I){G=I[B];for(E=0,F=G.length;E<F;E++){C=G[E];if(!C){continue}J[J.length]='Content-Disposition: form-data; name="'+B+'";'+(C.fileName&&C.getAsBinary?' filename="'+C.fileName+'"'+H+C.getAsBinary():H+C)}}return J},getQueryString:function(G){var I=this.toObject(G),B,C,H,D,J=[],E,F=/%20/g;for(B in I){H=I[B];D=encodeURIComponent(B);for(C=0,E=H.length;C<E;C++){J[J.length]=D+"="+encodeURIComponent(H[C]).replace(F,"+")}}return J.join("&")},serialize:function(B){var C=this.form.method.toLowerCase();if(C=="get"){return this.form.action+"?"+this.getQueryString(B)}if(C=="post"){if(this.form.enctype=="multipart/form-data"){return this.getMultipartFormData(B)}return this.getQueryString(B)}}}}();