(function(){if(typeof APE!=="undefined"){throw Error("APE is already defined.")}self.APE={namespace:K,mixin:N,extend:S,createFactory:R,getById:Q,deferError:D,toString:function(){return"[APE JavaScript Library]"}};function J(){}var A=0,U="instances",O="prototype",B=Object[O],M=B.hasOwnProperty,C=Function[O].toString,V=["toString","valueOf"];function K(Z){var a=Z.split("."),X=self,Y=0,F=a.length,W;for(;Y<F;Y++){W=a[Y];if(!G(X,W)){X[W]=new P((X.qualifiedName||"APE")+"."+W)}X=X[W]}return X}function N(Y,X){var Z,W=0,F;for(Z in X){if(G(X,Z)){Y[Z]=X[Z]}}for(;W<V.length;W++){F=V[W];if(G(X,F)){Y[F]=X[F]}}return Y}function S(F,Y,W){J[O]=Y[O];var X=F[O]=new J;if(typeof W=="object"){APE.mixin(X,W)}X.constructor=F;return F}function D(F){self.setTimeout(function(){throw F},1)}function R(F,X){return{getById:W,getByNode:W};function W(Y){if(typeof Y.id=="string"){arguments[0]=I(Y)}if(!(U in this)){if(typeof X==="function"){F[O]=X()}}return E.call(this,F,arguments)}}function E(W,F){var X=F[0];if(!G(this,U)){this[U]={}}return this[U][X]||(this[U][X]=H(W,F))}function Q(F){return E.call(this,this,arguments)}function I(F){var X=F.id,W;if(!X){W=T(this)||"APE";X=F.id=W+"_"+(A++)}return X}function T(F){if(typeof F.name==="string"){return F.name}var W=C.call(F).match(/\s([a-z]+)\(/i);return W&&W[1]||""}function H(Y,W){var X,F=J[O]=Y[O];F.constructor=Y;X=new J;Y.apply(X,W);return X}P[O].toString=function(){return"["+this.qualifiedName+"]"};function P(F){this.qualifiedName=F}function G(X,W){if(W in X){if(M){return M.call(X,W)}var F=X.__proto__;if(F){return !(W in F)||F[W]!==X[W]}return B[W]!==X[W]}return false}if(M&&!M.call(self,"Object")){var L=M;M=B.hasOwnProperty=function(F){return(this===self)?(F in this&&this[F]!==B[F]):L.call(this,F)}}})();APE.EventPublisher=function(B,A){this.src=B;this._callStack=[];this.type=A};APE.EventPublisher.prototype={add:function(B,A){this._callStack.push([B,A||this.src]);return this},addBefore:function(B,A){return APE.EventPublisher.add(this,"beforeFire",B,A||this.src)},addAfter:function(B,A){return APE.EventPublisher.add(this,"afterFire",B,A||this.src)},getEvent:function(A){return APE.EventPublisher.get(this,A)},remove:function(B,A){var E=this._callStack,C,D;if(!A){A=this.src}for(C=0;C<E.length;C++){D=E[C];if(D[0]===B&&D[1]===A){return E.splice(C,1)}}return null},removeBefore:function(B,A){return this.getEvent("beforeFire").remove(B,A||this.src)},removeAfter:function(B,A){return this.getEvent("afterFire").remove(B,A||this.src)},fire:function(A){return APE.EventPublisher.fire(this)(A)},toString:function(){return"APE.EventPublisher: {src="+this.src+", type="+this.type+", length="+this._callStack.length+"}"}};APE.EventPublisher.add=function(D,C,B,A){return APE.EventPublisher.get(D,C).add(B,A)};APE.EventPublisher.fire=function(B){return A;function A(H){var D=false,F,G=B._callStack,C;if(typeof B.beforeFire=="function"){try{if(B.beforeFire(H)==false){D=true}}catch(E){APE.deferError(E)}}for(F=0;F<G.length;F++){C=G[F];try{if(C[0].call(C[1],H)==false){D=true}}catch(E){APE.deferError(E)}}if(typeof B.afterFire=="function"){if(B.afterFire(H)==false){D=true}}return !D}};APE.EventPublisher.get=function(E,D){var C=this.Registry[D]||(this.Registry[D]=[]),A,B;for(A=0;A<C.length;A++){if(C[A].src===E){return C[A]}}B=new APE.EventPublisher(E,D);if(E[D]){B.add(E[D],E)}E[D]=this.fire(B);C[C.length]=B;return B};APE.EventPublisher.Registry={};APE.EventPublisher.cleanUp=function(){var C,E,D,B,A;for(C in this.Registry){E=this.Registry[C];for(B=0,A=E.length;B<A;B++){D=E[B];D.src[D.type]=null}}};if(window.CollectGarbage){APE.EventPublisher.get(window,"onunload").addAfter(APE.EventPublisher.cleanUp,APE.EventPublisher)}APE.namespace("APE.dom");(function(){var F=APE.dom,A="ownerDocument",E=document,G=E.documentElement,D=G&&A in G?A:"document",C="textContent",B=E.defaultView;F.OWNER_DOCUMENT=D;F.IS_COMPUTED_STYLE=(typeof B!="undefined"&&"getComputedStyle" in B);F.textContent=C in G?C:"innerText"})();(function(){APE.mixin(APE.dom,{getScrollOffsets:A,getViewportDimensions:C});var B="documentElement",E=document[B],D=E&&E.clientWidth===0;E=null;function A(H){H=H||window;var G,I=H.document,F=I[B];if("pageXOffset" in H){G=function(){return{left:H.pageXOffset,top:H.pageYOffset}}}else{if(D){F=I.body}G=function(){return{left:F.scrollLeft,top:F.scrollTop}}}I=null;this.getScrollOffsets=G;return G()}function C(J){J=J||window;var G=J.document,K=G,I="client",L,H;if(typeof K.clientWidth=="number"){}else{if(D||F(J)){G=K.body}else{if(K[B].clientHeight>0){G=K[B]}else{if(typeof innerHeight=="number"){G=J;I="inner"}}}}L=I+"Width";H=I+"Height";return(this.getViewportDimensions=function(){return{width:G[L],height:G[H]}})();function F(N){var O=N.document,P=O.createElement("div");P.style.height="2500px";O.body.insertBefore(P,O.body.firstChild);var M=O[B].clientHeight>2400;O.body.removeChild(P);return M}}})();(function(){var b=APE.dom;APE.mixin(b,{getOffsetCoords:c,isAboveElement:F,isBelowElement:W,isInsideElement:L});var i=this.document,a,h=i.documentElement,e=Math.round,Y=Math.max,D="getComputedStyle",C="defaultView",Q=h&&h.clientWidth===0,R="clientTop" in h,P=/^h/.test(h.tagName)?"table":"TABLE",M="currentStyle" in h,T,E,f,V,S,O,G,J,A,N,g,H=i[C]&&typeof i[C][D]!="undefined",I="getBoundingClientRect",d="relative",Z="borderTopWidth",B="borderLeftWidth",K=/^(?:r|a)/,U=/^(?:a|f)/;i=h=null;function c(k,AC,AI){var AO=k[b.OWNER_DOCUMENT],AM=AO.documentElement,z=AO.body;if(!AC){AC=AO}if(!AI){AI={x:0,y:0}}if(k===AC){AI.x=AI.y=0;return AI}if(I in k){var AK=Q?z:AM,v=k[I](),u=v.left+Y(AM.scrollLeft,z.scrollLeft),s=v.top+Y(AM.scrollTop,z.scrollTop),AH,AE=AK.clientTop,l=AK.clientLeft;if(R){u-=l;s-=AE}if(AC!==AO){v=c(AC,null);u-=v.x;s-=v.y;if(R){if(Q&&AC===z){u-=l;s-=AE}else{if(AC!==AO&&AC!==AM&&AC!==z){u-=AC.clientLeft;s-=AC.clientTop}}}}if(Q&&M&&AC!=AO&&AC!==z){AH=z.currentStyle;u+=parseFloat(AH.marginLeft)||0+parseFloat(AH.left)||0;s+=parseFloat(AH.marginTop)||0+parseFloat(AH.top)||0}AI.x=u;AI.y=s;return AI}else{if(H){if(!a){X()}var q=k.offsetLeft,AJ=k.offsetTop,AF=AO[C],p=AF[D](k,"");if(p.position=="fixed"){AI.x=q+AM.scrollLeft;AI.y=AJ+AM.scrollTop;return AI}var w=AF[D](z,""),AA=!K.test(w.position),o=k,r=k.parentNode,j=k.offsetParent;for(;r&&r!==AC;r=r.parentNode){if(r!==z&&r!==AM){q-=r.scrollLeft;AJ-=r.scrollTop}if(r===j){if(r===z&&AA){}else{if(!T&&!(r.tagName===P&&S)){var n=AF[D](r,"");q+=parseFloat(n[B])||0;AJ+=parseFloat(n[Z])||0}if(r!==z){q+=j.offsetLeft;AJ+=j.offsetTop;o=j;j=r.offsetParent}}}}var t=0,AG=0,AN,AB,AL=AC===AO||AC===AM,AD,m;if(o!=AO){m=AF[D](o,"").position;AN=U.test(m);AB=AN||K.test(m)}if((o===k&&k.offsetParent===z&&!E&&AC!==z&&!(AA&&V))||(E&&o===k&&!AB)||!AA&&AB&&G&&AL){AG+=parseFloat(w.marginTop)||0;t+=parseFloat(w.marginLeft)||0}if(AC===z){AD=AF[D](AM,"");if((!AA&&((A&&!AN)||(N&&AN)))||AA&&J){AG-=parseFloat(AD.paddingTop)||0;t-=parseFloat(AD.paddingLeft)||0}if(g){if(!AB||AB&&!AA){AG-=parseFloat(AD.marginTop)||0}t-=parseFloat(AD.marginLeft)||0}}if(AA){if(O||(!AN&&!T&&AL)){AG+=parseFloat(w[Z]);t+=parseFloat(w[B])}}else{if(V){if(AL){if(!f){AG+=parseFloat(w.top)||0;t+=parseFloat(w.left)||0;if(AN&&T){AG+=parseFloat(w[Z]);t+=parseFloat(w[B])}}if(AC===AO&&!AA&&!A){if(!AD){AD=AF[D](AM,"")}AG+=parseFloat(AD.paddingTop)||0;t+=parseFloat(AD.paddingLeft)||0}}else{if(f){AG-=parseFloat(w.top);t-=parseFloat(w.left)}}if(E&&(!AB||AC===z)){AG-=parseFloat(w.marginTop)||0;t-=parseFloat(w.marginLeft)||0}}}AI.x=e(q+t);AI.y=e(AJ+AG);return AI}}}function X(){a=true;var AA=document,n=AA.body;if(!n){return}var j="marginTop",AC="position",p="padding",y="static",t="border",o=n.style,AD=o.cssText,w="1px solid transparent",k="0",r="1px",u="offsetTop",q=AA.documentElement.style,AB=q.cssText,m=AA.createElement("div"),l=m.style,v=AA.createElement(P);o[p]=o[j]=o.top=k;q.position=y;o[t]=w;l.margin=k;l[AC]=y;m=n.insertBefore(m,n.firstChild);T=(m[u]===1);o[t]=k;v.innerHTML="<tbody><tr><td>x</td></tr></tbody>";v.style[t]="7px solid";v.cellSpacing=v.cellPadding=k;n.insertBefore(v,n.firstChild);S=v.getElementsByTagName("td")[0].offsetLeft===7;n.removeChild(v);o[j]=r;o[AC]=d;E=(m[u]===1);V=n[u]===0;o[j]=k;o.top=r;f=m[u]===1;o.top=k;o[j]=r;o[AC]=l[AC]=d;G=m[u]===0;l[AC]="absolute";o[AC]=y;if(m.offsetParent===n){o[t]=w;l.top="2px";O=m[u]===1;o[t]=k;l[AC]=d;q[p]=r;o[j]=k;J=m[u]===3;o[AC]=d;A=m[u]===3;l[AC]="absolute";N=m[u]===3;q[p]=k;q[j]=r;g=m[u]===3}n.removeChild(m);o.cssText=AD||"";q.cssText=AB||""}function L(k,j){var m=c(k).y,l=c(j).y;return m+k.offsetHeight<=l+j.offsetHeight&&m>=l}function F(k,j){return(c(k).y<=c(j).y)}function W(k,j){return(c(k).y+k.offsetHeight>=c(j).y+j.offsetHeight)}})();(function(){APE.mixin(APE.dom,{hasToken:E,removeClass:J,addClass:F,getElementsByClassName:K,findAncestorWithClass:H});var G="className";function E(M,L){return B(L,"").test(M)}function J(M,L){var N=M[G];if(!N){return}if(N===L){M[G]="";return}M[G]=C(N.replace(B(L,"g")," "))}function F(M,L){if(!M[G]){M[G]=L}if(!B(L).test(M[G])){M[G]+=" "+L}}var A={};function B(M,L){var N=M+"$"+L;return(A[N]||(A[N]=RegExp("(?:^|\\s)"+M+"(?:$|\\s)",L)))}function K(M,N,T){if(!T){return[]}N=N||"*";if(M.getElementsByClassName&&(N==="*")){return M.getElementsByClassName(T)}var O=B(T,""),Q=M.getElementsByTagName(N),R=Q.length,L=0,P,S=Array(R);for(P=0;P<R;P++){if(O.test(Q[P][G])){S[L++]=Q[P]}}S.length=L;return S}function H(O,L,M){if(O==null||O===M){return null}var P=B(L,""),N;for(N=O.parentNode;N!=M;){if(P.test(N[G])){return N}N=N.parentNode}return null}var D=/^\s+|\s+$/g,I=/\s\s+/g;function C(L){return L.replace(D,"").replace(I," ")}})();(function(){var D=document.documentElement,B="getNamedItem" in D.attributes,K="nodeType",L="compareDocumentPosition",I="parentNode",F=/^H/.test(D.tagName)?"toUpperCase":"toLowerCase";APE.mixin(APE.dom,{contains:H(),findAncestorWithAttribute:A,findAncestorWithTagName:J,findNextSiblingElement:C,findPreviousSiblingElement:E,getChildElements:G});D=null;function H(){if(L in D){return function(N,M){return(N[L](M)&16)!==0}}else{if("contains" in D){return function(N,M){return N!==M&&N.contains(M)}}}return function(N,M){if(N===M){return false}while(N!==M&&(M=M[I])!==null){}return N===M}}function A(O,R,P){for(var M,Q,N=O[I];N!==null;){Q=N.attributes;if(!Q||!B){return null}M=Q.getNamedItem(R);if(M&&M.specified){if(M.value===P||(P===undefined)){return N}}N=N[I]}return null}function J(O,M){M=M[F]();for(var N=O[I];N!==null;){if(N.tagName===M){return N}N=N[I]}return null}function C(N){for(var M=N.nextSibling;M!==null;M=M.nextSibling){if(M[K]===1){return M}}return null}function E(M){for(var N=M.previousSibling;N!==null;N=N.previousSibling){if(N[K]===1){return N}}return null}function G(Q){var P=0,O,N=[],M,S=Q.childNodes,R;for(M=S.length,O=0;P<M;P++){R=S[P];if(R[K]!==1){continue}N[O++]=R}return N}})();(function(){var A="addEventListener" in this,F=A?"target":"srcElement";APE.mixin(APE.dom.Event={},{eventTarget:F,getTarget:D,addCallback:E,removeCallback:G,preventDefault:B});function D(H){return(H||window.event)[F]}function C(I,H){return A?H:function(J){H.call(I,J)}}function E(K,J,H){if(A){K.addEventListener(J,H,false)}else{var I=C(K,H);K.attachEvent("on"+J,I)}return I||H}function G(J,I,H){if(A){J.removeEventListener(I,H,false)}else{J.detachEvent("on"+I,H)}return H}function B(H){H=H||window.event;if("preventDefault" in H){H.preventDefault()}else{if("returnValue" in H){H.returnValue=false}}}})();APE.namespace("APE.dom.Event");(function(){var C=APE.dom,A=C.Event;A.getCoords=B;function B(E){var D;if("pageX" in E){D=function(F){return{x:F.pageX,y:F.pageY}}}else{D=function(G){var F=C.getScrollOffsets();G=G||window.event;return{x:G.clientX+F.left,y:G.clientY+F.top}}}return(A.getCoords=D)(E)}})();(function(){var Q=APE.dom;APE.mixin(Q,{getStyle:D,setOpacity:S});var R="getComputedStyle",E=Q.IS_COMPUTED_STYLE,P="currentStyle",O="opacity",F="style",G="px",J="filter",I="alpha("+O+"=",M=/^(?:margin|(border)(Width|Color|Style)|padding)$/,N=/\Wopacity\s*=\s*([\d]+)/i,A=/^auto|\d%$/,T="cssFloat",L=T in document.documentElement[F]?T:"styleFloat",C=["Top","Right","Bottom","Left"];function K(W){var Y,X=W[J];if(!N.test(X)){return 1}Y=N.exec(X);return Y[1]/100}function S(Z,W){var Y=Z[F],X;if(O in Y){Y[O]=W}else{if(J in Y){Y[J]=I+(W*100)+")";X=Z[P];if(X&&!X.hasLayout){Y.zoom=1}}}}function D(X,W){var e="",b,a,Y,Z,c,d=X[Q.OWNER_DOCUMENT];if(/float/.test(W)){W=L}if(E){b=d.defaultView[R](X,"");if(!(W in b)){return""}e=b[W];if(e===""){e=U(b,W).join(" ")}if(W=="zIndex"&&e=="normal"){return"0"}if(A.test(e)){e=V(X,W)}}else{b=X[P];if(W===O){e=K(b)}else{e=b[W];if(A.test(e)){e=V(X,W)}else{if(!(W in b)){return""}}}a=H.exec(e);if(a){Y=e.split(" ");Y[0]=B(X,a[0]);for(Z=1,c=Y.length;Z<c;Z++){a=H.exec(Y[Z]);Y[Z]=B(X,a[0])}e=Y.join(" ")}}return e}function V(Y,X){var e=Y[F],d,Z,W,c=Y[Q.OWNER_DOCUMENT];if("pixelWidth" in e&&/width|height|top|left/.test(X)){Z="pixel"+(X.charAt(0).toUpperCase())+X.substring(1);d=e[Z]}if(d){return d+G}var a=Y.clientTop||0,b=Y.clientLeft||0;if(X==="width"){W=parseFloat(D(Y,"borderRightWidth"))||b;paddingWidth=parseFloat(D(Y,"paddingLeft"))||0+parseFloat(D(Y,"paddingRight"))||0;return Y.offsetWidth-b-W-paddingWidth+G}else{if(X==="height"){W=parseFloat(D(Y,"borderBottomWidth"))||a;paddingWidth=parseFloat(D(Y,"paddingTop"))||0+parseFloat(D(Y,"paddingBottom"))||0;return Y.offsetHeight-a-W+G}else{if(X=="margin"&&Y[P].position!="absolute"){d=parseFloat(D(Y.parentNode,"width"))-Y.offsetWidth;if(d==0){return"0px"}d="0px "+d;return d+" "+d}}}return"0"}function U(c,X){var Y=M.exec(X),a,g,b,e,f,d=true,W,Z=1;if(Y&&Y[0]){W=C;a=Y[1]||Y[0];g=Y[2]||""}else{return[""]}b=c[a+W[0]+g];f=[b];while(Z<4){e=c[a+W[Z]+g];d=d&&e==b;b=e;f[Z++]=e}if(d){return[b]}return f}var H=/(-?\d+|(?:-?\d*\.\d+))(?:em|ex|pt|pc|in|cm|mm\s*)/;function B(a,b){if(a.runtimeStyle){if(parseFloat(b)===0){return"0px"}var Z=a[F],Y=Z.left,X=a.runtimeStyle,W=X.left;X.left=a[P].left;Z.left=(b||0);b=Z.pixelLeft+G;Z.left=Y;X.left=W;return b}}})();