APE.namespace("APE.color");APE.color.ColorRGB=function(C,B,A){this.r=C;this.g=B;this.b=A};APE.color.ColorRGB.fromNumber=function(A){return new APE.color.ColorRGB((16711680&A)>>16,(65280&A)>>8,255&A)};APE.color.ColorRGB.fromHexString=function(E){if(!this.hexPattern.test(E)){throw Error("ColorRGB.fromHexString(hex) invalid input: "+E)}var F=parseInt(E.substring(1),16),D,C,B,A=APE.color.ColorRGB;if(E.length==4){D=F&3840,C=F&240,B=F&15;return new A((D>>4)+(D>>8),C+(C>>4),(B<<4)+B)}return A.fromNumber(F)};APE.color.ColorRGB.hexPattern=/(?:#)[0-9a-f]{3,6}/i;APE.color.ColorRGB.rgbPattern=/rgb\(([\d]{1,3})\,\s?([\d]{1,3})\,\s?([\d]{1,3})\)/;APE.color.ColorRGB.fromString=function(B){var A=APE.color.ColorRGB;return(A.hexPattern.test(B)?A.fromHexString(B):A.fromRgbString(B))};APE.color.ColorRGB.fromRgbString=function(C){var A=APE.color.ColorRGB,B=C.match(A.rgbPattern);if(B!=null){return new A(B[1],B[2],B[3])}return new A()};APE.color.ColorRGB.blend=function(H,F,G,C){var B=(G>1?0:1-G),E=H.r*B+F.r*G,D=H.g*B+F.g*G,A=H.b*B+F.b*G;E=(E^(E>>31))-(E>>31);D=(D^(D>>31))-(D>>31);A=(A^(A>>31))-(A>>31);if(C&&"r" in C){C.r=E;C.g=D;C.b=A;return C}return new this(E,D,A)};APE.color.ColorRGB.prototype={r:255,g:255,b:255,toHSV:function(){var A=Math.max(this.r,this.g,this.b),B=Math.min(this.r,this.g,this.b),D=0,C=0;if(A>B){switch(A){case this.r:C=(this.g-this.b)/(A-B);break;case this.g:C=2+((this.b-this.r)/(A-B));break;case this.b:C=4+((this.r-this.g)/(A-B));break}D=(A-B)/A}C*=60;if(C<0){C+=360}return new APE.color.ColorHSV(C,D,A/255)},toString:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},toHexString:function(){return"#"+A(this.r)+A(this.g)+A(this.b);function A(C){var B=C.toString(16);return(B.length==2?B:"0"+B)}},equals:function(A){return(this.r==A.r)&&(this.b==A.b)&&(this.g==A.g)},isValid:function(){return A(this.r)&&A(this.g)&&A(this.b);function A(B){return isFinite(B)&&B>=0&&B<=255}},valueOf:function(){return(this.r<<16)+(this.g<<8)+this.b}};APE.color.ColorHSV=function(C,B,A){this.h=C;this.s=B;this.v=A};APE.color.ColorHSV.rgbForHue=function(A){if(A===360){A=0}return new APE.color.ColorHSV(A,1,1).toRGB()};APE.color.ColorHSV.prototype={h:360,s:1,v:1,toRGB:function(){var L=this.h/360,D=this.s,C=this.v;var F,M,A;if(D==0){F=M=A=C}else{L*=6;var I=L>>0,K=C*(1-D),J=C*(1-D*(L-I)),E=C*(1-D*(1-(L-I)));switch(I){case 0:F=C;M=E;A=K;break;case 1:F=J;M=C;A=K;break;case 2:F=K;M=C;A=E;break;case 3:F=K;M=J;A=C;break;case 4:F=E;M=K;A=C;break;default:F=C;M=K;A=J}}return new APE.color.ColorRGB(F*255>>0,M*255>>0,A*255>>0)},toString:function(){return"[ "+this.h.toFixed(0)+", "+this.s.toFixed(2)+", "+this.v.toFixed(2)+" ]"}};