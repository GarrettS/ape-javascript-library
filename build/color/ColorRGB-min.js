APE.namespace("APE.color");
(function(){function g(a,b,c){this.r=a;this.g=b;this.b=c}function k(a){return new g((16711680&a)>>16,(65280&a)>>8,255&a)}function l(a){if(!m.test(a))throw Error("ColorRGB.fromHexString(hex) invalid: "+a);var b=parseInt(a.substring(1),16),c;if(a.length==4){a=b&3840;c=b&240;b=b&15;return new g((a>>4)+(a>>8),c+(c>>4),(b<<4)+b)}return k(b)}function q(a){return m.test(a)?l(a):n(a)}function n(a){a=a.match(r);if(a!=null)return new g(a[1],a[2],a[3]);return new g}function s(a,b,c,d){var e=c>1?0:1-c,f=a.r*
e+b.r*c,h=a.g*e+b.g*c;a=a.b*e+b.b*c;f=(f^f>>31)-(f>>31);h=(h^h>>31)-(h>>31);a=(a^a>>31)-(a>>31);if(d&&"r"in d){d.r=f;d.g=h;d.b=a;return d}return new g(f,h,a)}function j(a){return isFinite(a)&&a>=0&&a<=255}function i(a,b,c){this.h=a;this.s=b;this.v=c}function t(a){if(a===360)a=0;return(new i(a,1,1)).toRGB()}var o=self.APE,p=o.color,m=/(?:\s|^)#(?:[\da-f]{3}|[\da-f]{6})(?:\s|$)/i,r=/rgb\((\d{1,3}),\s?(\d{1,3}),\s?(\d{1,3})\)/;p.ColorRGB=g;p.ColorHSV=i;o.mixin(g,{fromNumber:k,fromString:q,fromHexString:l,
fromRgbString:n,blend:s});g.prototype={r:255,g:255,b:255,toHSV:function(){var a=Math.max(this.r,this.g,this.b),b=Math.min(this.r,this.g,this.b),c=0,d=0;if(a>b){switch(a){case this.r:d=(this.g-this.b)/(a-b);break;case this.g:d=2+(this.b-this.r)/(a-b);break;case this.b:d=4+(this.r-this.g)/(a-b);break}c=(a-b)/a}d*=60;if(d<0)d+=360;return new i(d,c,a/255)},toString:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},toHexString:function(){function a(b){b=b.toString(16);return b.length===2?b:"0"+
b}return"#"+a(this.r)+a(this.g)+a(this.b)},equals:function(a){return this.r===a.r&&this.b===a.b&&this.g===a.g},isValid:function(){return j(this.r)&&j(this.g)&&j(this.b)},valueOf:function(){return(this.r<<16)+(this.g<<8)+this.b}};i.rgbForHue=t;i.prototype={h:360,s:1,v:1,toRGB:function(){var a=this.h/360,b=this.s,c=this.v,d;if(b===0)d=a=c=c;else{a*=6;d=a|0;var e=c*(1-b),f=c*(1-b*(a-d));b=c*(1-b*(1-(a-d)));switch(d){case 0:d=c;a=b;c=e;break;case 1:d=f;a=c;c=e;break;case 2:d=e;a=c;c=b;break;case 3:d=
e;a=f;c=c;break;case 4:d=b;a=e;c=c;break;default:d=c;a=e;c=f}}return new g(d*255|0,a*255|0,c*255|0)},toString:function(){return"[ "+this.h.toFixed(0)+", "+this.s.toFixed(2)+", "+this.v.toFixed(2)+" ]"}}})();
