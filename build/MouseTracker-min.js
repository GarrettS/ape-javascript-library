APE.MouseTracker={subscribers:{},activeObject:null,register:function(D,E){E=E||D.id;if(!this.subscribers.hasOwnProperty(E)){this.subscribers[E]=[]}if(!this.inited){this.init()}var B=this.subscribers[E],C=0,A=B.length;while(C<A){if(D=B[C++]){return false}}B[C]=D;return true},unregister:function(D,E){E=E||D.id;var B=this.subscribers[E],C=0,A;if(B){A=B.length;while(C++<A){if(B[C]===D){B.splice(C,1)}}}return B},init:function(){var B=document,C=B.documentElement,A=C.style;APE.EventPublisher.add(B,"onmousedown",this.mouseDown,this);APE.EventPublisher.add(B,"onkeypress",this.keyPressed,this);APE.EventPublisher.add(B,"onmousemove",this.mouseMove,this);APE.EventPublisher.add(B,"onmouseup",this.mouseUp,this);if("onselectstart" in B){APE.EventPublisher.get(B,"onselectstart").addBefore(this.hasActiveObject,this)}else{APE.EventPublisher.get(B,"onmousedown").addAfter(this.preventUserSelection,this);APE.EventPublisher.get(B,"onmouseup").addAfter(this.preventUserSelection,this)}this.inited=true;this.userSelectType="MozUserSelect" in A?"MozUserSelect":"KhtmlUserSelect" in A?"KhtmlUserSelect":"userSelect" in A?"userSelect":""},hasActiveObject:function(){return this.activeObject!=null},preventUserSelection:function(){document.documentElement.style[this.userSelectType]=(this.activeObject?"none":"")},mouseDown:function(G){if(!G){G=event}var C=window.APE,D=C.dom,H=D.Event.getTarget(G),B=null,A=C.MouseTracker.subscribers,E=0,F;for(var I=H;B==null&&I!=null;I=D.findAncestorWithAttribute(I,"id")){if(I!==null){B=A[I.id]}}if(B){this.mousedownX=("pageX" in G?G.pageX:G.clientX+scrollOffsets.left);this.mousedownY=("pageY" in G?G.pageY:G.clientY+scrollOffsets.top);for(var F=B.length;E<F;E++){if(B[E].mouseDown(G)){this.activeObject=B[E]}}}},getEventCoords:APE.dom.Event.getCoords,mouseMove:function(F){var D=this.activeObject;if(!F){F=event}if(D==null){return}var E=this.getEventCoords(F),B=E.x,G=E.y,C=B-this.mousedownX,A=G-this.mousedownY;D.newX=D.origX+C;D.newY=D.origY+A;D.mouseMove(F)},mouseUp:function(B){if(this.activeObject==null){return}if(!B){B=event}var A=this.activeObject;if(A.mouseUp(B)){this.activeObject=null}},keyPressed:function(){}};